/* ======= SETTINGS ======= */
const BACKEND_URL = "https://YOUR-BACKEND-URL.replit.app";

/* ======= MOVABLE WELCOME MESSAGE & GREETING ======= */
const welcome = document.getElementById("welcome-msg");
let pos = 0, dir = 1;

function updateGreeting() {
  const hour = new Date().getHours();
  let greeting = "Welcome!";
  if(hour < 12) greeting = "Good morning!";
  else if(hour < 18) greeting = "Good afternoon!";
  else greeting = "Good evening!";
  welcome.textContent = `${greeting} Welcome to A.D Derrick Redeemerâ€™s Portfolio`;
}
updateGreeting();

function moveText() {
  pos += dir * 1.5;
  if(pos > window.innerWidth - 300 || pos < 0) dir *= -1;
  welcome.style.transform = `translateX(${pos}px)`;
  requestAnimationFrame(moveText);
}
moveText();

/* ======= GHANA FLAG BACKGROUND ANIMATION ======= */
const canvas = document.getElementById("bg-canvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const colors = ["#f00","#ff0","#008000"];
let colorIndex = 0;

function animateBG() {
  ctx.fillStyle = colors[colorIndex];
  ctx.fillRect(0, 0, canvas.width, canvas.height/3);
  ctx.fillStyle = colors[(colorIndex+1)%3];
  ctx.fillRect(0, canvas.height/3, canvas.width, canvas.height/3);
  ctx.fillStyle = colors[(colorIndex+2)%3];
  ctx.fillRect(0, (2*canvas.height)/3, canvas.width, canvas.height/3);

  colorIndex = (colorIndex + 1) % 3;
  requestAnimationFrame(animateBG);
}
animateBG();

/* ======= DARK/LIGHT MODE ======= */
const modeBtn = document.getElementById("mode-toggle");
modeBtn.onclick = () => {
  document.body.classList.toggle("dark");
  document.body.classList.toggle("light");
  if(document.body.classList.contains("dark")) modeBtn.textContent = "â˜€ï¸";
  else modeBtn.textContent = "ðŸŒ™";
};
document.body.classList.add("light");

/* ======= SUBSCRIBE FORM ======= */
document.getElementById("subscribe-form").onsubmit = e => {
  e.preventDefault();
  const email = document.getElementById("sub-email").value;
  const phone = document.getElementById("sub-phone").value;
  const viaEmail = document.getElementById("choose-email").checked;
  const viaSMS = document.getElementById("choose-sms").checked;

  if(!email && !phone){
    document.getElementById("subscribe-message").textContent = "Please enter at least email or phone.";
    return;
  }

  fetch(`${BACKEND_URL}/subscribe`, {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify({email, phone, viaEmail, viaSMS})
  }).then(()=>document.getElementById("subscribe-message").textContent="Subscribed!")
    .catch(()=>document.getElementById("subscribe-message").textContent="Subscription failed.");
};
